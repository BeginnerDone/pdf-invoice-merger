# PDF工具集合

一个功能丰富的PDF处理工具集，包含PDF合并、数据提取、转图片合并等多种实用功能。

## 功能特点

### 1. PDF发票合并
- 🔍 **智能匹配**: 自动匹配相同文件名的PDF和图片
- 📄 **A4布局**: 上半部分显示PDF发票，下半部分显示查验图片
- 🖼️ **多格式支持**: 支持PNG、JPG、JPEG、BMP、TIFF、GIF等图片格式
- ⚙️ **可配置**: 通过config.json自定义输入输出文件夹
- 📦 **批量处理**: 一次处理多个文件对

### 2. PDF转图片合并
- 🖼️ **PDF转图片**: 将PDF文件转换为高质量图片
- 📐 **网格排列**: 智能计算最佳网格布局
- 🏷️ **文件标签**: 为每个图片添加文件名标签
- 🎨 **自定义样式**: 可配置DPI、边距、背景色等参数
- 📏 **自适应缩放**: 自动调整图片大小以适应网格布局

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 快速开始（推荐）

运行统一入口程序，通过菜单选择需要的功能：

```bash
python main.py
```

程序会显示功能菜单：
```
🔧 PDF工具集合
==================================================
1. PDF发票合并 - 将PDF发票和查验图片合并成一个PDF
2. PDF转图片合并 - 将多个PDF转换为图片并排列合并
0. 退出程序
==================================================
```

### 功能详细说明

#### 1. PDF发票合并

**准备文件**：将PDF发票和对应的查验图片放入 `input` 文件夹，确保文件名相同：

```
input/
├── 发票001.pdf
├── 发票001.png
├── 发票002.pdf
└── 发票002.jpg
```

**运行结果**：合并后的PDF文件将保存在 `output` 文件夹中：

```
output/
├── 发票001_merged.pdf
└── 发票002_merged.pdf
```

#### 2. PDF转图片合并

**准备文件**：将需要转换的PDF文件放入 `input` 文件夹

**运行结果**：转换后的合并图片将保存在 `output` 文件夹中，所有PDF会按网格排列在一张大图上

## 配置说明

编辑 `config.json` 文件可以自定义设置：

```json
{
  "input_folder": "input",     // 输入文件夹路径
  "output_folder": "output"    // 输出文件夹路径
}
```

## 项目结构

```
pdf-invoice-merger/
├── main.py                  # 统一入口程序
├── pdf_merger.py           # PDF合并功能
├── pdf_to_image_merger.py  # PDF转图片合并功能
├── config.json             # 配置文件
├── requirements.txt        # 依赖包列表
├── README.md              # 说明文档
├── input/                 # 输入文件夹
└── output/                # 输出文件夹
```

## 注意事项

- 确保PDF文件和图片文件的文件名完全相同（不包括扩展名）
- 程序会自动创建输出文件夹
- 支持中文文件名
- 如果PDF有多页，只会使用第一页

## 错误处理

程序会自动处理以下情况：
- 配置文件不存在或格式错误时使用默认配置
- 跳过无法处理的文件并继续处理其他文件
- 显示详细的处理进度和错误信息